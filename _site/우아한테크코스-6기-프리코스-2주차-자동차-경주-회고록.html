<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>[우아한테크코스 6기] 프리코스 2주차 - 자동차 경주 회고록</title><!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="[우아한테크코스 6기] 프리코스 2주차 - 자동차 경주 회고록" />
<meta name="author" content="byeonghyeon kang" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="byeonghyeon kang’s dev blog" />
<meta property="og:description" content="byeonghyeon kang’s dev blog" />
<link rel="canonical" href="http://localhost:4000/byeonghyeon-kang/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BD%94%EC%8A%A4-6%EA%B8%B0-%ED%94%84%EB%A6%AC%EC%BD%94%EC%8A%A4-2%EC%A3%BC%EC%B0%A8-%EC%9E%90%EB%8F%99%EC%B0%A8-%EA%B2%BD%EC%A3%BC-%ED%9A%8C%EA%B3%A0%EB%A1%9D.html" />
<meta property="og:url" content="http://localhost:4000/byeonghyeon-kang/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BD%94%EC%8A%A4-6%EA%B8%B0-%ED%94%84%EB%A6%AC%EC%BD%94%EC%8A%A4-2%EC%A3%BC%EC%B0%A8-%EC%9E%90%EB%8F%99%EC%B0%A8-%EA%B2%BD%EC%A3%BC-%ED%9A%8C%EA%B3%A0%EB%A1%9D.html" />
<meta property="og:site_name" content="Hi, I’m Byeonghyeon Kang 👋🧑‍💻" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-11-02T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="[우아한테크코스 6기] 프리코스 2주차 - 자동차 경주 회고록" />
<script type="application/ld+json">
{"datePublished":"2023-11-02T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/byeonghyeon-kang/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BD%94%EC%8A%A4-6%EA%B8%B0-%ED%94%84%EB%A6%AC%EC%BD%94%EC%8A%A4-2%EC%A3%BC%EC%B0%A8-%EC%9E%90%EB%8F%99%EC%B0%A8-%EA%B2%BD%EC%A3%BC-%ED%9A%8C%EA%B3%A0%EB%A1%9D.html"},"url":"http://localhost:4000/byeonghyeon-kang/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BD%94%EC%8A%A4-6%EA%B8%B0-%ED%94%84%EB%A6%AC%EC%BD%94%EC%8A%A4-2%EC%A3%BC%EC%B0%A8-%EC%9E%90%EB%8F%99%EC%B0%A8-%EA%B2%BD%EC%A3%BC-%ED%9A%8C%EA%B3%A0%EB%A1%9D.html","author":{"@type":"Person","name":"byeonghyeon kang"},"@type":"BlogPosting","description":"byeonghyeon kang’s dev blog","headline":"[우아한테크코스 6기] 프리코스 2주차 - 자동차 경주 회고록","dateModified":"2023-11-02T00:00:00+09:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/byeonghyeon-kang/feed.xml" title="Hi, I’m Byeonghyeon Kang 👋🧑‍💻" /><link rel="shortcut icon" type="image/x-icon" href="/byeonghyeon-kang/logo.png" />
  <link rel="stylesheet" href="/byeonghyeon-kang/assets/css/main.css" />
</head><body a="auto">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <a href="/byeonghyeon-kang/">..</a><article>
  <p class="post-meta">
    <time datetime="2023-11-02 00:00:00 +0900">2023-11-02</time>
  </p>
  
  <h1>[우아한테크코스 6기] 프리코스 2주차 - 자동차 경주 회고록</h1>

  <p><br />
<br />
<br /></p>

<h1 id="1-주제">1. 주제</h1>

<p><img src="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/eb7c07e7-141f-4400-8de0-578a0b955092/%E1%84%83%E1%85%A1%E1%84%8B%E1%85%AE%E1%86%AB%E1%84%85%E1%85%A9%E1%84%83%E1%85%B3/w=384,quality=90,fit=scale-down" alt="다운로드.png" /></p>

<p>2주차 미션은 자동차 경주 미션이었다.</p>

<p>1주차 미션에서 배운 내용과 코드리뷰를 토대로 이번 미션에 적용하려고하니 기대가 샘솟았다.</p>

<p>요구사항을 살펴본 바로는 Jest를 활용해 테스트 코드를 작성해야 할 것 같다.</p>

<p>이번에는 테스트 코드를 어떻게 작성해야 하는지에 대해 더욱 심층적으로 학습하고 적용해보려 한다.</p>

<p><br />
<br />
<br /></p>

<h1 id="2-공들인-부분">2. 공들인 부분</h1>

<h2 id="기능-목록-작성하기">기능 목록 작성하기</h2>

<p>저번 미션을 통해 기능 목록의 중요성을 인지하게 되면서 이번 미션에서도 구현을 시작하기 전에 기능 목록을 작성하였다.</p>

<p>저번 미션에서처럼 입력, 출력, 핵심 기능을 기준으로 나누었고 추가로 입력에 대한 예외 상황도 고려하여 작성하였다.</p>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gh"># 기능 목록</span>
<span class="p">
-</span> 입력 기능
  [ ] 자동차 이름을 입력받는 기능
  [ ] 시도할 횟수를 입력받는 기능
<span class="p">-</span> 출력 기능
  [ ] 사용자가 입력한 횟수만큼 자동차의 전진상태를 출력하는 기능
  [ ] 최종 우승자를 출력하는 기능
<span class="p">-</span> 핵심 기능
  [ ] 각 자동차를 전진 혹은 정지시키는 기능
  [ ] 최종 우승자를 가려내는 기능

<span class="gh"># 예외 상황</span>
<span class="p">
-</span> 자동차 이름 입력 예외 상황
  [ ] 입력한 자동차 이름이 5자 이하가 아닐 경우
  [ ] 맨 앞과 마지막이 쉼표로 끝 날 경우
<span class="p">-</span> 시도 횟수 입력 예외 상황
  [ ] 숫자가 아닌 경우
</code></pre></div></div>

<p>기능 목록 작성에는 정답이 없음을 알기에 구현 과정에서 필요에 따라 수정할 계획이다.</p>

<p>기능 목록을 수정해보며 내가 생각하는 최적의 기능 목록 작성법이 무엇인지 터득할거라고 생각했다.</p>

<p>이러한 접근 방식 덕분에 기능 목록 작성에 대한 부담감이 확실히 줄어든 것 같다.</p>

<h2 id="mvc-패턴-적용">MVC 패턴 적용</h2>

<p>자연스럽게 MVC패턴을 고려하게 되었다. 폴더에 어떤식으로 함수를 분리할지가 머리속에 그려지는 것 같았다.</p>

<p>정답은 없지만 미리 계획을 세워두면 기능 구현 때 도움이 될 것 같다는 생각이 들어 다음과 같이 작성해보았다.</p>

<p><img src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F13897cab-0dd6-431f-b847-04477372a586%2F1a6d7bd6-56d7-4b82-b0fe-37cd7935333a%2FJPEG_%25E1%2584%258B%25E1%2585%25B5%25E1%2584%2586%25E1%2585%25B5%25E1%2584%258C%25E1%2585%25B5-49F6-BBD1-65-0.jpeg?id=73326e88-d5e5-44e6-99bb-642bc0840fd6&amp;table=block" alt="JPEG 이미지-49F6-BBD1-65-0.jpeg" /></p>

<p><img src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F13897cab-0dd6-431f-b847-04477372a586%2Fc995be79-966b-4175-bc17-bb731ca8010a%2F%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-27_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_10.08.11.png?id=d455e2b3-f6f5-48cb-92a6-8f1dc82c8aa2&amp;table=block" alt="스크린샷 2023-10-27 오후 10.08.11.png" /></p>

<p>MVC 패턴을 적용하여 비슷한 역할을 하는 함수들을 분리해보았다.</p>

<p>작성하면서 ‘이렇게 까지 해도 괜찮을까?’라는 생각이 들었지만 자연스럽게 떠오르는 아이디어를 풀어나가며 다양하게 적용해보는 것이 보다 효율적인 프로그램 구현 방법을 찾는 과정임을 생각하며 작성하게 되었다.</p>

<h2 id="플로우-차트-그리기">플로우 차트 그리기</h2>

<p>기능 목록과 폴더구조에 따른 함수 분리까지 구상하는 것도 중요하지만 저번 미션에서는 컨트롤러 구현 시 에러로 인해 상당한 시간을 투자했던 기억이 난다.</p>

<p>그 원인은 제대로 된 프로그램 흐름을 파악하지 못했기 때문이라고 판단했고 이를 해결하기 위해 플로우 차트를 그려보기로 결정했다.</p>

<p>플로우 차트를 그리는 방법은 다양하지만 표준 플로우 차트 기호를 준수하였다.</p>

<h3 id="표준-플로우-차트-기호">표준 플로우 차트 기호</h3>

<p><img src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F13897cab-0dd6-431f-b847-04477372a586%2Fc90f3595-0b6a-4bc1-b3dd-2fc7651f8ca3%2F%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-11-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_9.11.33.png?id=e7c91b01-6ec7-484f-aea2-efec8fdece48&amp;table=block" alt="스크린샷 2023-11-01 오후 9.11.33.png" /></p>

<p>표준 기호들의 역할을 파악하고 이를 기반으로 그린 플로우 차트는 다음과 같다.</p>

<p><img src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F13897cab-0dd6-431f-b847-04477372a586%2F75ee8324-68b0-41d2-8c57-c2b55e1ee1b8%2F%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-11-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_9.11.14.png?id=34041205-f01a-41c2-bb60-b32e49ea25b6&amp;table=block" alt="스크린샷 2023-11-01 오후 9.11.14.png" /></p>

<p>플로우 차트를 직접 그려보니 협업 시 프로그램의 순서를 시각화하여 이해를 돕는데 큰 도움이 될 것 같다는 생각이 들었다.</p>

<p>하지만 플로우 차트를 그리는 것은 생각보다 많은 시간이 필요했다.</p>

<p>이로 인한 부담감을 느꼈고, 특히 최종 코딩테스트에서는 5시간이라는 제한된 시간 안에 플로우 차트까지 그리는 것은 비효율적일 것 같다는 생각이 들었다.</p>

<p>따라서 플로우 차트를 대신할 수 있는 다른 효율적인 방안을 찾아야겠다는 생각이 들었고, 그 결과 프로그램 순서를 리스트화하는 방법을 생각해냈다.</p>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">-</span> 사용자로부터 자동차 이름을 입력받는다.
<span class="p">  -</span> 자동차의 이름을 입력하지 않았는지 확인한다.
<span class="p">  -</span> 자동차의 이름이 5자 이하인지 확인한다.
<span class="p">  -</span> 자동차의 이름들을 입력할 시 잘못된 쉼표 구분을 하고 있는지 확인한다.
<span class="p">  -</span> 자동차의 이름이 중복되었는지 확인한다.
<span class="p">-</span> 사용자로부터 시도 횟수를 입력받는다.
<span class="p">  -</span> 시도 횟수를 입력하지 않았는지 확인한다.
<span class="p">  -</span> 숫자가 아닌 값을 입력하지 않았는지 확인한다.
<span class="p">-</span> 사용자로부터 입력받은 자동차를 인스턴스를 생성한다.
<span class="p">-</span> 실행결과를 출력한다.
<span class="p">  -</span> 실행결과 문구를 출력한다.
<span class="p">  -</span> 자동차들의 인스터스를 통한 전진상태를 출력한다.
<span class="p">-</span> 최종 우승자를 출력한다.
</code></pre></div></div>

<p>입력과 출력에 대한 순서를 크게 설정하고 그 안에서 수행하는 유효성 검사나 핵심 기능들을 세부적으로 리스트화하여 순서도를 작성하였다.</p>

<p>확실히 플로우 차트를 그리는 것보다 더 빠른 시간 안에 이해하고 정리할 수 있었다.</p>

<p>이를 바탕으로 컨트롤러를 작성하는데 큰 문제는 없었다.</p>

<p>하지만 앞으로의 미션을 수행하면서 효과적인 본인만의 기준을 찾는 것이 중요하다는 생각이들었다.</p>

<h2 id="코드리뷰-반영하기">코드리뷰 반영하기</h2>

<h3 id="구조-분해-할당으로-export-import하기">구조 분해 할당으로 export, import하기</h3>

<p><img src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F13897cab-0dd6-431f-b847-04477372a586%2F17298f00-4e8d-4cb0-b6dc-d9a2985f95b3%2F%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-27_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_9.22.09.png?id=04bf6ca9-1cc4-4d05-97f8-3e9e99f4fb64&amp;table=block" alt="스크린샷 2023-10-27 오후 9.22.09.png" /></p>

<p>다음과 같은 리뷰를 받았다. 기존에는 MissionUtils 객체를 import해서 Console과 Random을 접근했었는데 이를 직접 가져올 수 있다는 것을 알게되었다.</p>

<p>자세한 이유를 알고 싶어서 node_modules 내에 있는 @woowacourse/mission-utils를 확인해보았다.</p>

<p><img src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F13897cab-0dd6-431f-b847-04477372a586%2F1712e52b-2acc-4cd1-b28e-a8f9fad30f2d%2F%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-27_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_9.24.48.png?id=9e71a96d-272a-4cda-921d-7a8cc715f2e4&amp;table=block" alt="스크린샷 2023-10-27 오후 9.24.48.png" /></p>

<p>확인 결과 index.js에서 Random과 Console을 객체로 export하고 있었기 때문에 굳이 MissionUtils로 import하지 않아도 됐던 것이었다.</p>

<p>이를 통해 기존에 작성한 코드도 export default로 자체를 export하다 보니 property에 접근할 때마다 중복되는 코드가 발생하였다는 것을 깨달았다.</p>

<p>만약 더 많은 상수가 정의되고 접근할 것이 많아진다면 문제는 훨씬 심해질 것으로 예상했다.</p>

<p>그래서 이번 주차 미션에서는 모든 파일의 객체들을 구조 분해하고 export하여 중복되는 코드를 줄이기로 결정했다.</p>

<p>예를 들어 constants 내부에 있는 ErrorString.js는 구조 분해 할당을 하여 다음과 같이 작성하였다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">ErrorString</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">ERROR_CARS_LENGTH</span><span class="p">:</span> <span class="dl">"</span><span class="s2">[Error] 자동차를 5개 이하로 입력해주세요.</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">ERROR_CARS_SPLIT</span><span class="p">:</span>
    <span class="dl">"</span><span class="s2">[Error] 자동차 이름 입력시 구분을 잘 해주세요.(이름은 쉽표(,) 기준으로 구분합니다.)</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">ERROR_COUNT_NOT_NUMBER</span><span class="p">:</span> <span class="dl">"</span><span class="s2">[Error] 숫자가 아닌 값을 입력하셨습니다.</span><span class="dl">"</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="p">{</span> <span class="nx">ERROR_CARS_LENGTH</span><span class="p">,</span> <span class="nx">ERROR_CARS_SPLIT</span><span class="p">,</span> <span class="nx">ERROR_COUNT_NOT_NUMBER</span> <span class="p">}</span> <span class="o">=</span>
  <span class="nx">ErrorString</span><span class="p">;</span>
</code></pre></div></div>

<p>이를 import하고 사용할 때는 다음과 같이 작성하면 된다.</p>

<p>이렇게 하면 객체에 일일이 접근할 필요가 없어 코드가 훨씬 간결해진 것을 확인할 수 있다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span>
  <span class="nx">ERROR_CARS_LENGTH</span><span class="p">,</span>
  <span class="nx">ERROR_CARS_SPLIT</span><span class="p">,</span>
  <span class="nx">ERROR_COUNT_NOT_NUMBER</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../constants/ErrorString.js</span><span class="dl">'</span>

<span class="nx">validateCarsInput</span><span class="p">(</span><span class="nx">inputCars</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">inputCarsArray</span> <span class="o">=</span> <span class="nx">inputCars</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="p">)</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">inputCarsArray</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">ERROR_CARS_LENGTH</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="단일-책임-원칙">단일 책임 원칙?</h3>

<p><img src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F13897cab-0dd6-431f-b847-04477372a586%2F0278b1aa-5926-4d9a-bb0f-b64a28523937%2F%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-27_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_9.32.00.png?id=7cc4fd21-7fb6-4daf-831d-f8495c6db642&amp;table=block" alt="스크린샷 2023-10-27 오후 9.32.00.png" /></p>

<p>생각해보면 <code class="language-plaintext highlighter-rouge">generateResultMessage</code>와 같은 메소드를 두어 책임을 분리했다면 메시지를 출력하는 역할만을 수행하는 기능을 만들 수 있었다.</p>

<p>이번 미션에는 단일 책임 원칙에 주의하여 로직을 분리하는 데에 신경을 썼다. 함수의 depth가 깊어지거나 내용이 너무 길다고 판단될 때마다 다시 한번 고민해보았다.</p>

<p>예를 들어 다음은 OutputView.js에 있는 메시지를 출력하는 기능에 대한 내용이다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">OutputView</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">printResultStartString</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">Console</span><span class="p">.</span><span class="nx">print</span><span class="p">(</span><span class="nx">OUTPUT_RESULT_START</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="na">printResulString</span><span class="p">:</span> <span class="p">(</span><span class="nx">cars</span><span class="p">,</span> <span class="nx">count</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">count</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">cars</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">car</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">driveAndStopCars</span><span class="p">(</span><span class="nx">car</span><span class="p">));</span>
      <span class="nx">Console</span><span class="p">.</span><span class="nx">print</span><span class="p">(</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="na">printWinnersString</span><span class="p">:</span> <span class="p">(</span><span class="nx">cars</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">winners</span> <span class="o">=</span> <span class="nx">findWinners</span><span class="p">(</span><span class="nx">cars</span><span class="p">);</span>
    <span class="nx">Console</span><span class="p">.</span><span class="nx">print</span><span class="p">(</span><span class="s2">`최종 우승자 : </span><span class="p">${</span><span class="nx">winners</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2">, </span><span class="dl">"</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
  <span class="p">},</span>
<span class="p">};</span>
</code></pre></div></div>

<p>이전 미션에서는 결과를 출력하는 기능에 볼, 스트라이크, 낫싱의 메시지를 생성하는 기능을 포함했었는데 이번 미션에서는 이들을 각각의 함수로 분리하여 utils 폴더에서 관리하도록 했다.</p>

<p>printResultString 함수를 살펴보면 이름과 레이싱 상태의 메시지를 출력하는 기능을 driveAndStopCars로 분리했다.</p>

<p>그 아래에 있는 printWinnersString 함수도 findWinners라는 함수로 분리하여 최종 우승자 메시지를 출력하는 기능을 별도로 분리했다.</p>

<p>이처럼 하나의 함수에 하나의 책임만 부여하도록 신경써 작성하였더니, 코드가 훨씬 간결해진 것을 확인할 수 있었다.</p>

<h3 id="class와-object-고려하기">class와 object 고려하기</h3>

<p><img src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F13897cab-0dd6-431f-b847-04477372a586%2F0649b80a-1a65-45e0-8103-bbcbcca1dfd5%2F%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-28_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_8.06.47.png?id=7579fd4a-b91e-4077-84a4-06c2a0e33302&amp;table=block" alt="스크린샷 2023-10-28 오후 8.06.47.png" /></p>

<p>1주차 미션에서는 InputView와 OutputView, 즉 view에 해당하는 부분을 객체 형태로 작성하였다.</p>

<p>그러나 리뷰에서는 이를 클래스로 통일하는 것이 좋을 것 같다는 의견을 남겨주셨다.</p>

<p>사실 다른 파일들은 클래스 형태로 작성하였지만 view만 객체 형태로 작성하고 있었다.</p>

<p>view가 다중 인스턴스를 생성하지 않기 때문에 객체로 간단하게 구현하고 싶었던 것 같다.</p>

<p>그래서 클래스와 객체 중 선택할 때 고려해야 할 판단 기준이 무엇인지 의문이 들었다. 찾아본 결과 크게 4가지를 고려할 수 있었다.</p>

<p><br /></p>

<p>첫번째는 재사용성이다. 클래스를 사용하면 다중 인스턴스를 생성할 수 있기 때문에 재사용성이 좋다. 그러나 이번 미션에서는 view가 다중 인스턴스를 필요로 하지 않기 때문에 클래스를 사용하기에는 적합하지 않다고 판단하였다.</p>

<p>두번째는 유지보수성이다. 클래스를 사용하면 상속 등을 통해 확장 가능성이 있다는 장점이 있다. 하지만 이번 미션에서는 View의 확장성이 필요 없었기 때문에 이 역시 클래스를 사용하기에는 적합하지 않다고 느꼈다.</p>

<p>세번째는 단순성이다. 객체로 작성하면 코드가 더 간단할 수 있다. 클래스를 정의하고 인스턴스화하는 것보다 객체를 만드는 것이 더 직관적일 수 있다고 판단하여 객체를 사용하는 것이 적합하다고 느꼈다.</p>

<p>네번째는 프로젝트 크기이다. 프로젝트 규모가 크다면 클래스로 작성하면 체계적으로 관리가 가능하지만 이번 미션의 규모는 그렇게 크지 않았기 때문에 객체를 사용하는 것이 간단하다고 생각하였다.</p>

<p><br /></p>

<p>이 4가지 요소를 모두 고려해볼 때, 객체로 작성하는 것이 더 적합하다고 생각하였다.</p>

<p>이 리뷰를 통해 클래스로 통일하지는 않았지만 객체와 클래스 설계 시 판단 기준을 재정립하는 데에 도움이 될 수 있었다. InputView를 예로 들면 작성한 코드는 다음과 같다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Console</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@woowacourse/mission-utils</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">INPUT_CARS_NAME</span><span class="p">,</span> <span class="nx">INPUT_COUNT</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../constants/InputString.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span>
  <span class="nx">ERROR_CARS_EMPTY</span><span class="p">,</span>
  <span class="nx">ERROR_CARS_LENGTH</span><span class="p">,</span>
  <span class="nx">ERROR_CARS_SPLIT</span><span class="p">,</span>
  <span class="nx">ERROR_CARS_DUPLICATED</span><span class="p">,</span>
  <span class="nx">ERROR_COUNT_EMPTY</span><span class="p">,</span>
  <span class="nx">ERROR_COUNT_NOT_NUMBER</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../constants/ErrorString.js</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">InputView</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">readCarsInput</span><span class="p">:</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">},</span>

  <span class="na">readCountInput</span><span class="p">:</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">},</span>

  <span class="na">validateCarsInput</span><span class="p">:</span> <span class="p">(</span><span class="nx">inputCars</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">},</span>

  <span class="na">validateCountInput</span><span class="p">:</span> <span class="p">(</span><span class="nx">inputCount</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="p">{</span>
  <span class="nx">readCarsInput</span><span class="p">,</span>
  <span class="nx">readCountInput</span><span class="p">,</span>
  <span class="nx">validateCarsInput</span><span class="p">,</span>
  <span class="nx">validateCountInput</span><span class="p">,</span>
<span class="p">}</span> <span class="o">=</span> <span class="nx">InputView</span><span class="p">;</span>
</code></pre></div></div>

<p><br />
<br />
<br /></p>

<h1 id="3-시행착오">3. 시행착오</h1>

<h2 id="jest를-이용한-테스트-코드-작성하기">Jest를 이용한 테스트 코드 작성하기</h2>

<p>테스트 코드에 대해선 말로만 들어봤지 실제로 프론트엔드에서 사용해본 경험은 없었다.</p>

<p>이번 미션 요구사항에는 작성한 기능에 대한 테스트 코드를 작성하라는 항목이 있었기 때문에 Jest 프레임워크에 대한 기본적인 개념들을 확인해볼 필요가 있었다.</p>

<h3 id="jest란">Jest란</h3>

<p><img src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F13897cab-0dd6-431f-b847-04477372a586%2Fdc8952ce-e58a-416a-a34f-8c717e47a3ab%2Fjest.png?id=6dabf3b7-e34d-4381-9db2-78fbe5a39ae6&amp;table=block" alt="jest.png" /></p>

<p>Jest는 페이스북에서 개발한 자바스크립트 테스팅 라이브러리이다.</p>

<p>Jest는 Test Runner와 Test Matcher, 그리고 Test Mock 프레임워크를 제공하고 있다.</p>

<ol>
  <li><strong><code class="language-plaintext highlighter-rouge">describe()</code></strong>: 테스트 스위트를 정의하는 함수이다. 테스트 스위트는 특정 기능이나 모듈에 대한 관련된 테스트 케이스를 그룹화하는 역할을 한다.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">test()</code></strong>: 실제 테스트 케이스를 정의하는 함수이다. 각 <strong><code class="language-plaintext highlighter-rouge">test</code></strong> 함수는 특정 조건 또는 상황에 대한 테스트를 말한다.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">expect()</code></strong>: 값을 검사하고 검증하는 함수이다. 일반적으로 테스트 케이스 내에서 어떤 값이나 동작을 검사할 때 <strong><code class="language-plaintext highlighter-rouge">expect</code></strong> 함수를 사용한다.</li>
  <li><strong>matcher</strong>: <strong><code class="language-plaintext highlighter-rouge">expect</code></strong> 함수와 함께 사용되고 예상한 결과와 실제 결과를 비교하고 테스트를 평가하는 역할을 한다. Jest는 다양한 Matcher를 제공하는데 예상한 결과와 실제 결과를 비교하고 테스트가 성공했는지 여부를 결정한다. 일반적으로 <strong><code class="language-plaintext highlighter-rouge">toEqual</code></strong>, <strong><code class="language-plaintext highlighter-rouge">toBe</code></strong>, <strong><code class="language-plaintext highlighter-rouge">not.toBe</code></strong>, <strong><code class="language-plaintext highlighter-rouge">toContain</code></strong>, <strong><code class="language-plaintext highlighter-rouge">toThrow</code></strong> 등이 있다.</li>
</ol>

<h3 id="코드-분석">코드 분석</h3>

<p>Jest에 대한 이해를 높이기 위해 <code class="language-plaintext highlighter-rouge">__test__</code>폴더 내에 있는 ApplicationTest.js 파일을 분석하기로 결정했다.</p>

<h3 id="mocking-메소드에-대하여">Mocking 메소드에 대하여</h3>

<h3 id="jestfn">jest.fn</h3>

<p>Jest는 jest.fn() 함수를 제공하여 가짜 함수(mock function)를 생성할 수 있다.</p>

<p>가짜 함수를 생성하는 이유는 실제 입력을 기다리지 않고도 원하는 입력값을 이용하여 테스트 케이스를 시뮬레이션할 수 있기 때문이다.</p>

<p>jest.fn의 종류는 다음과 같다.</p>

<ol>
  <li><strong><code class="language-plaintext highlighter-rouge">mockReturnValue()</code></strong>: mocking 함수가 호출될 때 항상 특정 값을 반환하도록 설정할 수 있다.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">mockImplementation()</code></strong>: mocking 함수가 호출될 때 특정 동작을 수행하도록 설정할 수 있다.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">mockResolvedValue()</code> / <code class="language-plaintext highlighter-rouge">mockRejectedValue()</code></strong>: Promise를 반환하는 mocking 함수에서 사용된다. <strong><code class="language-plaintext highlighter-rouge">mockResolvedValue()</code></strong> 함수를 사용하여 Promise가 성공할 때 반환할 값을 설정하고, <strong><code class="language-plaintext highlighter-rouge">mockRejectedValue()</code></strong> 함수를 사용하여 Promise가 실패할 때 반환할 값을 설정할 수 있다.</li>
</ol>

<p>이를 바탕으로 mockQuestions와 mockRandoms 두 함수가 하는 역할을 살펴보았다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">mockQuestions</span> <span class="o">=</span> <span class="p">(</span><span class="nx">inputs</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">MissionUtils</span><span class="p">.</span><span class="nx">Console</span><span class="p">.</span><span class="nx">readLineAsync</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">();</span>

  <span class="nx">MissionUtils</span><span class="p">.</span><span class="nx">Console</span><span class="p">.</span><span class="nx">readLineAsync</span><span class="p">.</span><span class="nx">mockImplementation</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">input</span> <span class="o">=</span> <span class="nx">inputs</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
    <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre></div></div>

<p>mockQuestions 함수는 <code class="language-plaintext highlighter-rouge">mockImplementation</code>을 통해 재정의하여 사용자의 다음 입력값을 순서대로 반환하는 가짜 함수를 만들었다는 것을 알 수 있다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">mockRandoms</span> <span class="o">=</span> <span class="p">(</span><span class="nx">numbers</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">MissionUtils</span><span class="p">.</span><span class="nx">Random</span><span class="p">.</span><span class="nx">pickNumberInRange</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">();</span>
  <span class="nx">numbers</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">acc</span><span class="p">,</span> <span class="nx">number</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">acc</span><span class="p">.</span><span class="nx">mockReturnValueOnce</span><span class="p">(</span><span class="nx">number</span><span class="p">);</span>
  <span class="p">},</span> <span class="nx">MissionUtils</span><span class="p">.</span><span class="nx">Random</span><span class="p">.</span><span class="nx">pickNumberInRange</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div>

<p>mockRandoms 함수는 numbers 배열을 순회하면서 누적된 결과를 생성하는 가짜 함수임을 알 수 있다.</p>

<h3 id="jestspyon">jest.spyOn</h3>

<p>jest.spyOn() 함수는 특정 객체의 함수가 얼마나 많이 호출되었는지 그리고 어떤 인자가 넘어갔는지에 대한 정보를 얻을 수 있는 기능을 제공한다.</p>

<ol>
  <li><strong><code class="language-plaintext highlighter-rouge">toHaveBeenCalled()</code></strong>: 해당 메서드가 최소 한 번 호출되었는지 확인한다.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">toHaveBeenCalledTimes(n)</code></strong>: 해당 메서드가 정확히 <strong><code class="language-plaintext highlighter-rouge">n</code></strong> 번 호출되었는지 확인한다.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">toHaveBeenCalledWith(arg1, arg2, ...)</code>:</strong> 해당 메서드가 특정 인수와 함께 호출되었는지 확인한다. <strong><code class="language-plaintext highlighter-rouge">arg1</code></strong>, <strong><code class="language-plaintext highlighter-rouge">arg2</code></strong>, 등은 예상되는 인수이다.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">toHaveBeenLastCalledWith(arg1, arg2, ...)</code></strong>: 해당 메서드가 마지막 호출될 때 특정 인수와 함께 호출되었는지 확인한다.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">toHaveBeenNthCalledWith(n, arg1, arg2, ...)</code></strong>: 해당 메서드가 호출 중 <strong><code class="language-plaintext highlighter-rouge">n</code></strong> 번째 호출되었을 때 특정 인수와 함께 호출되었는지 확인한다.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">toHaveReturned()</code></strong>: 해당 메서드가 어떤 값을 반환했는지 확인한다.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">toHaveReturnedTimes(n)</code></strong>: 해당 메서드가 정확히 <strong><code class="language-plaintext highlighter-rouge">n</code></strong> 번 값을 반환했는지 확인한다.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">toHaveLastReturned()</code></strong>: 해당 메서드가 마지막 호출될 때 어떤 값을 반환했는지 확인한다.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">toHaveNthReturned(n, value)</code></strong>: 해당 메서드가 호출 중 <strong><code class="language-plaintext highlighter-rouge">n</code></strong> 번째 호출되었을 때 특정 값을 반환했는지 확인한다.</li>
</ol>

<p>이를 기반으로 getLogSpy 함수가 수행하는 역할을 살펴보았다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">getLogSpy</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">logSpy</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">spyOn</span><span class="p">(</span><span class="nx">MissionUtils</span><span class="p">.</span><span class="nx">Console</span><span class="p">,</span> <span class="dl">"</span><span class="s2">print</span><span class="dl">"</span><span class="p">);</span>
  <span class="nx">logSpy</span><span class="p">.</span><span class="nx">mockClear</span><span class="p">();</span>
  <span class="k">return</span> <span class="nx">logSpy</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<p>개념을 이해한 후에는 getLogSpy의 역할을 생각보다 쉽게 해석할 수 있었다.</p>

<p>먼저, MissionUtils.Console 객체의 print 메소드를 스파이로 설정하였다.</p>

<p>그 후에 <code class="language-plaintext highlighter-rouge">mockClear()</code>를 사용하여 스파이의 동작을 초기화하고 초기화된 스파이 객체를 반환하는 함수임을 알 수 있다.</p>

<p>이를 통해 getLogSpy 메소드를 호출하여 객체를 변수에 할당하고 Console.print 메소드에 대한 정보를 검증(expect)할 때 사용할 수 있도록 하는 함수인 것을 알 수 있었다.</p>

<h3 id="기능별-테스트-코드-작성">기능별 테스트 코드 작성</h3>

<p>Jest에 대한 기본적인 개념과 작성법에 대해 어느 정도 이해하였다고 가정하고 본격적으로 어떤 기능들을 테스트할 것인지 결정해보았다.</p>

<p>먼저 테스트 스위트를 크게 나누어 보았다.</p>

<p>자동차 경주의 핵심 기능, 자동차 이름 입력의 예외 상황, 시도 횟수 입력의 예외 상황이 이 세 가지 주요 요소였다.</p>

<p>그리고 각 함수에 대한 테스트 케이스를 다음과 같이 설정하였다.</p>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gs">**자동차 경주의 핵심 기능 테스트**</span>
<span class="p">
-</span> 자동차 경주 게임 - 자동차 입력에 따른 Car클래스 인스턴스 생성 기능 - 사용자가 입력한 횟수만큼 자동차의 전진상태를 출력하는 기능 - 최종 우승자를 가려내는 기능
  <span class="gs">**입력에 따른 유효성 테스트**</span>
<span class="p">-</span> 자동차 이름 입력 예외 상황
<span class="p">  -</span> 아무 값도 입력하지 않았을 경우
<span class="p">  -</span> 입력한 자동차의 이름이 5자 이하가 아닐 경우
<span class="p">  -</span> 자동차 이름이 서로 같을 경우
<span class="p">  -</span> 맨 앞과 마지막이 쉼표로 끝날 경우
<span class="p">-</span> 시도 횟수 입력 예외 상황
<span class="p">  -</span> 아무 값도 입력하지 않았을 경우
<span class="p">  -</span> 숫자가 아닌 경우
</code></pre></div></div>

<p><img src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F13897cab-0dd6-431f-b847-04477372a586%2F4cb592ed-8ca8-4db2-a698-2e1f366acc50%2F%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-11-01_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_5.55.08.png?id=bc8becfb-aa4e-4a67-92ae-4f78615199e5&amp;table=block" alt="스크린샷 2023-11-01 오후 5.55.08.png" /></p>

<p>위와 같이 구상한 후에는 InputValidTest.js와 CarRacingTest.js로 나누어 테스트 코드를 작성하였다.</p>

<h3 id="디버깅">디버깅</h3>

<h3 id="자동차의-전진상태를-반환하는-함수driveandstopcars">자동차의 전진상태를 반환하는 함수(driveAndStopCars)</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Console</span><span class="p">,</span> <span class="nx">Random</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@woowacourse/mission-utils</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">driveAndStopCars</span> <span class="o">=</span> <span class="p">(</span><span class="nx">car</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">Random</span><span class="p">.</span><span class="nx">pickNumberInRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="nx">car</span><span class="p">.</span><span class="nx">drive</span><span class="p">();</span>

  <span class="nx">Console</span><span class="p">.</span><span class="nx">print</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">car</span><span class="p">.</span><span class="nx">getName</span><span class="p">()}</span><span class="s2"> : </span><span class="p">${</span><span class="nx">car</span><span class="p">.</span><span class="nx">getStatus</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="dl">""</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">driveAndStopCars</span><span class="p">;</span>
</code></pre></div></div>

<p>기존에는 dirveAndStopCars 함수에서 자동차의 전진 상태를 결정하고 이를 콘솔에 출력하는 방식으로 작성하였다.</p>

<p>그러나 테스트 코드를 작성하면서 의문점이 생겼다.</p>

<p>바로 해당 함수를 테스트 코드로 작성하고자 했지만 Console.print() 함수를 사용하고 있어서 테스트하기 어려웠다.</p>

<p>이에 대해 다시 생각해보니 OutputView의 역할은 콘솔에 출력하는 것이지만 이 역할을 driveAndStopCars 함수에서 수행하고 있었다.</p>

<p>이는 해당 함수가 담당하지 않아야 할 책임을 부여하는 문제를 일으키면서 테스트 코드를 작성하는 데에도 어려움을 초래하였다.</p>

<p>따라서 이를 다음과 같이 수정하였다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// driveAndStop.js</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">Random</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@woowacourse/mission-utils</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">driveAndStopCars</span> <span class="o">=</span> <span class="p">(</span><span class="nx">car</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">Random</span><span class="p">.</span><span class="nx">pickNumberInRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="nx">car</span><span class="p">.</span><span class="nx">drive</span><span class="p">();</span>

  <span class="k">return</span> <span class="s2">`</span><span class="p">${</span><span class="nx">car</span><span class="p">.</span><span class="nx">getName</span><span class="p">()}</span><span class="s2"> : </span><span class="p">${</span><span class="nx">car</span><span class="p">.</span><span class="nx">getStatus</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="dl">""</span><span class="p">)}</span><span class="s2">`</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">driveAndStopCars</span><span class="p">;</span>

<span class="c1">// OutputView.js</span>
<span class="nl">printResulString</span><span class="p">:</span> <span class="p">(</span><span class="nx">cars</span><span class="p">,</span> <span class="nx">count</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">count</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Console</span><span class="p">.</span><span class="nx">print</span><span class="p">(</span><span class="nx">cars</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">car</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">driveAndStopCars</span><span class="p">(</span><span class="nx">car</span><span class="p">)).</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">));</span>
    <span class="nx">Console</span><span class="p">.</span><span class="nx">print</span><span class="p">(</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<p>driveAndStopCars 함수는 자동차의 전진 상태에 대한 배열 값을 반환하도록 수정되었고 이를 호출하는 OutputView의 printResultString에서는 출력만 담당하도록 변경하였다.</p>

<p>이 변경으로 인해 driveAndStopCars 함수에 대한 반환 값으로 테스트 코드를 작성할 수 있게 되었다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">mockRandoms</span> <span class="o">=</span> <span class="p">(</span><span class="nx">numbers</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">Random</span><span class="p">.</span><span class="nx">pickNumberInRange</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">();</span>
  <span class="nx">numbers</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">number</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">Random</span><span class="p">.</span><span class="nx">pickNumberInRange</span><span class="p">.</span><span class="nx">mockReturnValueOnce</span><span class="p">(</span><span class="nx">number</span><span class="p">));</span>
<span class="p">};</span>

<span class="nx">test</span><span class="p">(</span><span class="dl">"</span><span class="s2">사용자가 입력한 횟수만큼 자동차의 전진상태를 출력하는 기능</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">randoms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>
  <span class="nx">mockRandoms</span><span class="p">(</span><span class="nx">randoms</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">input</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">pobi, kang</span><span class="dl">"</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">receivedValue</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">expectedValue</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">pobi : </span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">kang : --</span><span class="dl">"</span><span class="p">];</span>

  <span class="kd">const</span> <span class="nx">carRacingController</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CarRacingController</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">carInstances</span> <span class="o">=</span> <span class="nx">carRacingController</span><span class="p">.</span><span class="nx">createCarInstances</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">count</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">receivedValue</span> <span class="o">=</span> <span class="nx">carInstances</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">car</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">driveAndStopCars</span><span class="p">(</span><span class="nx">car</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="nx">expect</span><span class="p">(</span><span class="nx">receivedValue</span><span class="p">).</span><span class="nx">toStrictEqual</span><span class="p">(</span><span class="nx">expectedValue</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<p>무작위 예측값을 고정하고 각각의 자동차 인스턴스마다 driveAndStopCars 함수를 호출하여 최종 결과값을 receivedValue에 할당하여 테스트하였다.</p>

<h3 id="맨-앞과-마지막이-쉼표로-끝-날-경우">맨 앞과 마지막이 쉼표로 끝 날 경우</h3>

<p>예외 상황을 처리하기 위해 사용자로부터 차량 이름을 입력받을 때 맨 앞이나 뒤에 쉼표가 있을 경우 에러 메시지를 출력하도록 처리하려 했다.</p>

<p>그러나 테스트와 index.js를 실행해봤을 때 중복 오류 메시지가 출력되는 것을 발견하였다.</p>

<p>이를 통해 입력 처리 부분에 문제가 있다는 것을 파악하고 코드를 다시 확인해보았다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">validateCarsInput</span><span class="p">:</span> <span class="nx">inputCars</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">inputCarsArray</span> <span class="o">=</span> <span class="nx">inputCars</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">inputCar</span> <span class="o">=&gt;</span> <span class="nx">inputCar</span><span class="p">.</span><span class="nx">trim</span><span class="p">())</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">inputCarsArray</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">inputCars</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">ERROR_CARS_EMPTY</span><span class="p">)</span>
    <span class="nx">inputCarsArray</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">inputCar</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">inputCar</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">ERROR_CARS_LENGTH</span><span class="p">)</span>
    <span class="p">})</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">inputCarsArray</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">(</span><span class="nx">inputCarsArray</span><span class="p">).</span><span class="nx">size</span><span class="p">)</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">ERROR_CARS_DUPLICATED</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">inputCarsArray</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">''</span><span class="p">))</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">ERROR_CARS_SPLIT</span><span class="p">)</span>
  <span class="p">},</span>
</code></pre></div></div>

<p><img src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F13897cab-0dd6-431f-b847-04477372a586%2Fdbfc959d-7100-479c-beb6-7e1266005e6b%2F%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-29_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_5.44.28.png?id=f423425a-a365-426e-a762-0dd02fea1576&amp;table=block" alt="스크린샷 2023-10-29 오후 5.44.28.png" /></p>

<p><img src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F13897cab-0dd6-431f-b847-04477372a586%2F5a4d5f7c-efe6-4950-b593-cfb01608dcdd%2F%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-29_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_6.00.06.png?id=a991812f-2ae4-4e32-bb0b-c3a90e5a4b41&amp;table=block" alt="스크린샷 2023-10-29 오후 6.00.06.png" /></p>

<p>확인해본 결과 문제는 ‘공백이 포함되어 있는 경우’가 ‘중복이 발생하는 경우’보다 후순위에 있었던 것이었다.</p>

<p>왜냐하면 맨 앞과 뒤에 동시에 쉼표가 있을 경우 두 개의 공백을 인식하게 되고, 이를 중복으로 파악하게 되기 때문이다.</p>

<p>따라서 ‘공백이 포함되어 있는 경우’를 ‘중복이 발생하는 경우’보다 우선 순위를 높여서 이 문제를 해결할 수 있었다.</p>

<p>변경된 코드는 다음과 같다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">validateCarsInput</span><span class="p">:</span> <span class="nx">inputCars</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">inputCarsArray</span> <span class="o">=</span> <span class="nx">inputCars</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">inputCar</span> <span class="o">=&gt;</span> <span class="nx">inputCar</span><span class="p">.</span><span class="nx">trim</span><span class="p">())</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">inputCarsArray</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">inputCars</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">ERROR_CARS_EMPTY</span><span class="p">)</span>
    <span class="nx">inputCarsArray</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">inputCar</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">inputCar</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">ERROR_CARS_LENGTH</span><span class="p">)</span>
    <span class="p">})</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">inputCarsArray</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">''</span><span class="p">))</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">ERROR_CARS_SPLIT</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">inputCarsArray</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">(</span><span class="nx">inputCarsArray</span><span class="p">).</span><span class="nx">size</span><span class="p">)</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">ERROR_CARS_DUPLICATED</span><span class="p">)</span>
  <span class="p">},</span>
</code></pre></div></div>

<p><br />
<br />
<br /></p>

<h1 id="4-리팩토링">4. 리팩토링</h1>

<h3 id="단일-책임-원칙-신경쓰기createcarinstances">단일 책임 원칙 신경쓰기(createCarInstances)</h3>

<p>모든 요구사항을 충족시킨 후, 코드 리뷰에서 단일 책임 원칙에 대한 의견을 듣고 controller의 코드를 다시 살펴보았다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Car</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../model/Car.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">readCarsInput</span><span class="p">,</span> <span class="nx">readCountInput</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../view/InputView.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span>
  <span class="nx">printResultStartString</span><span class="p">,</span>
  <span class="nx">printResulString</span><span class="p">,</span>
  <span class="nx">printWinnersString</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../view/OutputView.js</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">CarRacingController</span> <span class="p">{</span>
  <span class="err">#</span><span class="nx">carInstances</span><span class="p">;</span>

  <span class="nx">inputCars</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">};</span>

  <span class="nx">inputCount</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">cars</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">};</span>

  <span class="nx">printRacingResult</span> <span class="o">=</span> <span class="p">(</span><span class="nx">cars</span><span class="p">,</span> <span class="nx">count</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">carsArray</span> <span class="o">=</span> <span class="nx">cars</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">,</span><span class="dl">"</span><span class="p">).</span><span class="nx">map</span><span class="p">((</span><span class="nx">car</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">car</span><span class="p">.</span><span class="nx">trim</span><span class="p">());</span>
    <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">carInstances</span> <span class="o">=</span> <span class="nx">carsArray</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">car</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">car</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Car</span><span class="p">(</span><span class="nx">car</span><span class="p">)));</span>

    <span class="nx">printResultStartString</span><span class="p">();</span>
    <span class="nx">printResulString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">carInstances</span><span class="p">,</span> <span class="nx">count</span><span class="p">);</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">printRacingWinners</span><span class="p">();</span>
  <span class="p">};</span>

  <span class="nx">printRacingWinners</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">};</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">CarRacingController</span><span class="p">;</span>
</code></pre></div></div>

<p>사용자로부터 자동차 이름들과 시도 횟수를 입력받는 메소드에서는 각 기능들이 잘 분리되어 있다고 생각하였다.</p>

<p>그러나 경기 상태를 출력하는 메소드에서 사용자로부터 입력받은 자동차 이름들을 인스턴스화하고 있음을 확인하였다.</p>

<p>이 부분은 inputCars 메소드에서 처리하면 더 적절하다고 판단하였다.</p>

<p>이에 따라 다음과 같이 리팩토링을 진행하였다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Car</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../model/Car.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">readCarsInput</span><span class="p">,</span> <span class="nx">readCountInput</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../view/InputView.js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span>
  <span class="nx">printResultStartString</span><span class="p">,</span>
  <span class="nx">printResulString</span><span class="p">,</span>
  <span class="nx">printWinnersString</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../view/OutputView.js</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">CarRacingController</span> <span class="p">{</span>
  <span class="err">#</span><span class="nx">carInstances</span><span class="p">;</span>

  <span class="nx">inputCars</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">cars</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">readCarsInput</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">carsArray</span> <span class="o">=</span> <span class="nx">cars</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">,</span><span class="dl">"</span><span class="p">).</span><span class="nx">map</span><span class="p">((</span><span class="nx">car</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">car</span><span class="p">.</span><span class="nx">trim</span><span class="p">());</span>
    <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">carInstances</span> <span class="o">=</span> <span class="nx">carsArray</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">car</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">car</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Car</span><span class="p">(</span><span class="nx">car</span><span class="p">)));</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputCount</span><span class="p">();</span>
  <span class="p">};</span>

  <span class="nx">inputCount</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">};</span>

  <span class="nx">printRacingResult</span> <span class="o">=</span> <span class="p">(</span><span class="nx">count</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">printResultStartString</span><span class="p">();</span>
    <span class="nx">printResulString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">carInstance</span><span class="p">,</span> <span class="nx">count</span><span class="p">);</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">printRacingWinners</span><span class="p">();</span>
  <span class="p">};</span>

  <span class="nx">printRacingWinners</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">};</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">CarRacingController</span><span class="p">;</span>
</code></pre></div></div>

<p>해당 로직을 inputCars 메소드에서 처리하도록 변경하고, 불필요한 매개변수와 인수를 모두 제거하였다.</p>

<p>이렇게 변경한 결과, 기능에 맞게 잘 분리된 것을 확인할 수 있었다.</p>

<h3 id="시작-지점을-명확하게startcarracing">시작 지점을 명확하게(startCarRacing)</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">CarRacingController</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./controller/CarRacingController.js</span><span class="dl">'</span>

<span class="kd">class</span> <span class="nx">App</span> <span class="p">{</span>
  <span class="err">#</span><span class="nx">carRacingController</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CarRacingController</span><span class="p">()</span>

  <span class="k">async</span> <span class="nx">play</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">carRacingController</span><span class="p">.</span><span class="nx">inputCars</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">App</span>
</code></pre></div></div>

<p>기존에는 App.js에서 controller를 인스턴스화하고 inputCars를 호출하는 방식을 사용하였다.</p>

<p>그러나 이런 방식이면 다른 사람이 코드를 볼 때 해당 메소드가 시작 지점인지 명확하게 파악하기 어려울 것 같다는 생각이 들었다.</p>

<p>그래서 controller에 시작 지점을 명시하는 메소드를 추가하였다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// CarRacingController.js</span>

<span class="k">import</span> <span class="nx">Car</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../model/Car.js</span><span class="dl">'</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">readCarsInput</span><span class="p">,</span> <span class="nx">readCountInput</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../view/InputView.js</span><span class="dl">'</span>
<span class="k">import</span> <span class="p">{</span>
  <span class="nx">printResultStartString</span><span class="p">,</span>
  <span class="nx">printResulString</span><span class="p">,</span>
  <span class="nx">printWinnersString</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../view/OutputView.js</span><span class="dl">'</span>

<span class="kd">class</span> <span class="nx">CarRacingController</span> <span class="p">{</span>
  <span class="err">#</span><span class="nx">carInstances</span>

  <span class="nx">startCarRacing</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputCars</span><span class="p">()</span>
  <span class="p">}</span>

  <span class="c1">// ...</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">CarRacingController</span>

<span class="c1">// App.js</span>

<span class="k">import</span> <span class="nx">CarRacingController</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./controller/CarRacingController.js</span><span class="dl">'</span>

<span class="kd">class</span> <span class="nx">App</span> <span class="p">{</span>
  <span class="err">#</span><span class="nx">carRacingController</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CarRacingController</span><span class="p">()</span>

  <span class="k">async</span> <span class="nx">play</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">carRacingController</span><span class="p">.</span><span class="nx">startCarRacing</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">App</span>

</code></pre></div></div>

<p>startCarRacing이라는 메소드를 추가하여 리팩토링하였다.</p>

<p>이런 방식으로 코드를 작성하니시작 지점이 더욱 명확하게 드러나게 되는 것을 알 수 있다.</p>

<h3 id="한번에-할당하기findwinners">한번에 할당하기(findWinners)</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">findWinners</span> <span class="o">=</span> <span class="p">(</span><span class="nx">cars</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">carsStatus</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="kd">const</span> <span class="nx">winners</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="nx">cars</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">car</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">carsStatus</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">car</span><span class="p">.</span><span class="nx">getStatus</span><span class="p">().</span><span class="nx">length</span><span class="p">));</span>
  <span class="nx">cars</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">car</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(...</span><span class="nx">carsStatus</span><span class="p">)</span> <span class="o">===</span> <span class="nx">car</span><span class="p">.</span><span class="nx">getStatus</span><span class="p">().</span><span class="nx">length</span><span class="p">)</span>
      <span class="nx">winners</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">car</span><span class="p">.</span><span class="nx">getName</span><span class="p">());</span>
  <span class="p">});</span>

  <span class="k">return</span> <span class="nx">winners</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">findWinners</span><span class="p">;</span>
</code></pre></div></div>

<p>기존에는 변수를 따로 선언하고 할당하기 위한 로직을 작성하였다.</p>

<p>그러나 이를 한 번에 처리할 수 있는 방법을 고민하다가 다음과 같은 코드로 리팩토링하게 되었다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">findWinners</span> <span class="o">=</span> <span class="p">(</span><span class="nx">cars</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">maxStatusLength</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span>
    <span class="p">...</span><span class="nx">cars</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">car</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">car</span><span class="p">.</span><span class="nx">getStatus</span><span class="p">().</span><span class="nx">length</span><span class="p">)</span>
  <span class="p">);</span>
  <span class="kd">const</span> <span class="nx">winners</span> <span class="o">=</span> <span class="nx">cars</span>
    <span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">car</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">car</span><span class="p">.</span><span class="nx">getStatus</span><span class="p">().</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">maxStatusLength</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">car</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">car</span><span class="p">.</span><span class="nx">getName</span><span class="p">());</span>

  <span class="k">return</span> <span class="nx">winners</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">findWinners</span><span class="p">;</span>
</code></pre></div></div>

<p>전진 상태의 최대 길이를 구하기 위해 자동차 인스턴스의 배열을 순회하며 전진 상태를 가져오고 스프레드 연산자를 통해 최대값을 구하여 maxStatusLength에 한 번에 할당하였다.</p>

<p>그 다음으로 최종 우승자를 결정하기 위해 자동차 인스턴스 배열에서 이전에 구한 최대 전진 상태와 동일한 인스턴스를 추려냈다.</p>

<p>이를 다시 순회하여 우승자의 이름 배열을 winners에 한 번에 할당할 수 있었다.</p>

<p><br />
<br />
<br /></p>

<h1 id="5-회고">5. 회고</h1>

<p>저번 미션에서 다소 어려움을 겪었던 만큼, 이번 미션은 비교적 수월하게 진행한 것 같다.
이번 미션에서는 특히 이전 미션에서 받았던 코드 리뷰와 시행착오를 겪으면서 배운 내용들을 반영하는데 집중하였다.</p>

<p>특히 구현 전에 기능 목록과 플로우 차트를 구상하는 데 시간을 많이 들였다. 미션의 기능 구현과 코드 스타일 적용까지 약 3시간 정도로 빠르게 마무리한 것 같다. 이는 초기 구상과 세팅이 체계적인 설계와 시간 단축에 큰 도움이 된다는 것을 체감하게 되었다.</p>

<p>또한 Jest 프레임워크에 대해 알게 된 것도 큰 수확이었다. 객체 지향 설계를 공부하면서 GoogleTest를 통해 단위 테스트를 해본 경험이 있었지만, 프론트엔드에서도 과연 테스트가 필요할까? 라는 의문을 가지고 있었다. 그런데 이번에 Jest 프레임워크의 장점을 알게되면서 그런 의문을 해결할 수 있었다.</p>

<p>이번 미션까지 진행해보면서 점진적으로 성장하는 나 자신의 모습을 보며 뿌듯함을 느꼈다. 다음 미션에서도 어떤 부분이 나를 성장시킬 수 있을지 기대가 된다. 그동안 배운 것들을 바탕으로 더 많은 사람들의 코드를 보고 코드 리뷰도 받아보면서 부족한 부분을 계속해서 성장시켜 나갈 것이다.</p>

<p><br />
<br />
<br /></p>

<h1 id="6-다음-목표">6. 다음 목표</h1>

<ul>
  <li>프로그램 순서의 이해에 대한 최적의 기준 찾기</li>
  <li>더 많은 사람들의 코드를 분석하고 서로 코드 리뷰 해보면서 개선점 찾기</li>
  <li>Jest와 함께 테스트 코드에 친숙해지기</li>
</ul>

<p><br />
<br />
<br /></p>

<h1 id="7-구현-코드-보러가기">7. <a href="https://github.com/woowacourse-precourse/javascript-racingcar-6/pull/108">구현 코드 보러가기</a></h1>

</article>
      </div>
    </main>
  </body>
</html>